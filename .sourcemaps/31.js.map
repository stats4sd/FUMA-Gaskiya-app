{"version":3,"sources":["../../src/pages/security/users-management/users-management.module.ts","../../src/pages/security/users-management/users-management.ts"],"names":[],"mappings":"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","file":"31.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { UsersManagementPage } from './users-management';\n\n@NgModule({\n  declarations: [\n    UsersManagementPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(UsersManagementPage),\n  ],\n  exports: [UsersManagementPage] \n})\nexport class UsersManagementPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/security/users-management/users-management.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, AlertController, LoadingController, ViewController } from 'ionic-angular';\nimport { PouchdbProvider } from '../../../providers/pouchdb-provider';\nimport { Validators, FormBuilder } from '@angular/forms';\n\n/**\n * Generated class for the UsersManagementPage page.\n *\n * See http://ionicframework.com/docs/components/#navigation for more info\n * on Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-users-management',\n  templateUrl: 'users-management.html',\n})\nexport class UsersManagementPage {\n  selectedStyle: any = 'liste';\n  users: any = [];\n  page: any = 'liste';\n  user: any = {};\n  userForm: any;\n  nom: any;\n  prenom: any;\n  sex: any;\n  roles: any = [];\n  codes_unions: any = [];\n  unions: any = [];\n\n  constructor(public navCtrl: NavController, public alertCtl: AlertController, public loadingCtl: LoadingController, public formBuilder: FormBuilder, public navParams: NavParams, public viewCtrl: ViewController, public servicePouchdb: PouchdbProvider) {\n    \n    this.userForm = this.formBuilder.group({\n        nom: [''],\n        prenom: [''],\n        //username: ['', Validators.required],\n        //email: [this.user.email],\n        //mdpass: ['', Validators.required],\n        //confmdpass: ['', Validators.required],\n        //date: [this.user.date, Validators.required],\n        sex: [''],\n        roles: [''],\n        codes_unions: ['']\n    })\n  }\n\n  /*ionViewDidLoad() {\n    console.log('ionViewDidLoad UsersManagementPage');\n  }*/\n\n  ionViewDidEnter(){\n    this.servicePouchdb.getAllUsers('admin', 'admin').then((users) => {\n      if(users){\n        this.users = users;\n      }\n    });\n\n    this.getAllUnions();\n  }\n\n  detail(user){\n    this.user = user;\n    this.page = 'detail'\n  }\n\n  editer(user){\n    this.nom = user.nom;\n    this.prenom = user.prenom;\n    this.sex = user.sex;\n    this.roles = user.roles;\n    this.codes_unions = user.codes_unions;\n\n    this.page = 'edite'\n  }\n\n  getAllUnions(){\n    this.servicePouchdb.managerGetAllUnions().then((unions) => {\n      this.unions = unions;\n    }).catch((err) => {\n      alert(err)\n    })    \n  }\n\n  \n  sauvegarder(){\n    let loading = this.loadingCtl.create({\n      content: 'Mise à jour de l\\'utilisateur en cours...'\n    });\n    loading.present();\n    let user = this.userForm.value;\n    let grand_user = this.user;\n    grand_user.nom = user.nom;\n    grand_user.prenom = user.prenom;\n    grand_user.sex = user.sex;\n    grand_user.roles = user.roles;\n    grand_user.codes_unions = user.codes_unions;\n    \n    this.servicePouchdb.managerUpdateUser('admin','admin',grand_user).then((res) => {\n      loading.dismiss();\n\n      this.users[this.users.indexOf(user)] = user;\n      this.user = grand_user;\n      this.page = 'detail';\n    }).catch((err) => {\n       loading.dismiss();\n      alert(err);\n    })\n    \n  }\n\n  annuler(){\n\n    if(this.page === 'detail'){\n      this.page = 'liste';\n    }else if(this.page === 'edite'){\n      this.page = 'detail';\n    }else{\n      this.viewCtrl.dismiss();\n    }\n  }\n\n\n  supprimer(user){\n    let e: any = {};\n    let alert = this.alertCtl.create({\n      title: 'Suppression utilisateur',\n      message: 'Etes vous sûr de vouloir supprimer cet utilisateur ?',\n      buttons:[\n        {\n          text: 'Non',\n          handler: () => console.log('suppression annulée')\n \n        },\n        {\n          text: 'Oui',\n          handler: () => {\n            this.servicePouchdb.managerDeleteUser('admin', 'admin', user).then((res) => {\n              this.users.splice(this.users.indexOf(user), 1);\n              this.page = 'liste';\n              \n            }, err => {\n              console.log(err)\n            }) ;\n            \n          }\n        }\n      ]\n    });\n\n    alert.present();\n  }\n\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/security/users-management/users-management.ts"],"sourceRoot":""}