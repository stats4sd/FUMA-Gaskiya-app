{"version":3,"sources":["../../src/pages/champs/modifier-champs/modifier-champs.module.ts","../../src/pages/champs/modifier-champs/modifier-champs.ts"],"names":[],"mappings":"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","file":"65.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { ModifierChampsPage } from './modifier-champs';\r\n\r\n@NgModule({\r\n  declarations: [ModifierChampsPage],\r\n  imports: [IonicPageModule.forChild(ModifierChampsPage)],\r\n  exports: [ModifierChampsPage]\r\n})\r\nexport class ModifierChampsPageModule { }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/champs/modifier-champs/modifier-champs.module.ts","import { Component } from '@angular/core';\nimport { NavController, NavParams, ToastController, IonicPage } from 'ionic-angular';\nimport { Validators, FormBuilder } from '@angular/forms';\nimport { TranslateService } from '@ngx-translate/core';\nimport { Storage } from '@ionic/storage';\nimport { PouchdbProvider } from '../../../providers/pouchdb-provider';\nimport { Geolocation } from '@ionic-native/geolocation';\n\n/*\n  Generated class for the ModifierChamps page.\n\n  See http://ionicframework.com/docs/v2/components/#navigation for more info on\n  Ionic pages and navigation.\n*/\n\n@IonicPage()\n@Component({\n  selector: 'page-modifier-champs',\n  templateUrl: 'modifier-champs.html'\n})\nexport class ModifierChampsPage {\n\n  champsForm: any;\n  grandChamps: any;\n  champs: any;\n  typeSoles: any = [];\n  producteurs: any = [];\n  selectedTypeSole: any;\n  selectedProducteur: any = [];\n  nom_producteur: any = '';\n  allChamps: any;\n  id_champs: any;\n  ancienMatriculeProducteur: any;\n  longitude: any;\n  latitude: any;\n\n  constructor(public navCtrl: NavController, public navParams: NavParams, public toastCtl: ToastController, public geolocation: Geolocation, public servicePouchdb: PouchdbProvider, public formBuilder: FormBuilder, public storage: Storage) {\n    this.grandChamps = this.navParams.data.champ;\n    this.champs = this.grandChamps.data;\n\n    this.selectedProducteur = this.champs.matricule_producteur;\n    this.nom_producteur = this.champs.nom_producteur;\n    this.ancienMatriculeProducteur = this.champs.matricule_producteur;\n    this.selectedTypeSole = this.champs.type_sole;\n    this.id_champs = this.champs.id_champs;\n    this.longitude = this.champs.longitude;\n    this.latitude = this.champs.latitude;\n    \n    this.servicePouchdb.getPlageDocs('fuma:type-sole','fuma:type-sole:\\uffff').then((ts) => {\n          this.typeSoles = ts;\n      }, err => console.log(err)); \n      let p: any = [];\n      this.servicePouchdb.getPlageDocs('fuma:op:membre','fuma:op:membre:\\uffff').then((mbrA) => {\n        this.servicePouchdb.getPlageDocs('koboSubmission_fuma-op-membre','koboSubmission_fuma-op-membre\\uffff').then((mbrK) => {\n        this.producteurs = mbrA.concat(mbrK);\n      }, err => console.log(err));\n    }, err => console.log(err)); \n\n    \n    this.champsForm = this.formBuilder.group({\n      id_champs:[this.champs.id_champs],\n      nom: [this.champs.nom, Validators.required],\n      longitude: [this.champs.longitude],\n      latitude: [this.champs.latitude],\n      superficie: [this.champs.superficie, Validators.required],\n      type_sole: [this.champs.type_sole, Validators.required],\n      matricule_producteur: [this.champs.matricule_producteur],\n      nom_producteur: [this.champs.nom_producteur, Validators.required],\n    });\n    \n  }\n\n  getNomProducteur(){\n    this.producteurs.forEach((p, i) => {\n      if(p.data.matricule_Membre === this.selectedProducteur){\n        this.nom_producteur = p.data.nom_Membre;\n\n         if(this.ancienMatriculeProducteur !== p.data.matricule_Membre){\n            let id = this.generateId(p.data.matricule_Membre);\n            this.id_champs = id;\n          }else{\n            this.id_champs = this.ancienMatriculeProducteur;\n          }\n      } \n    });\n\n    \n  }\n\n  msg(msg: string = ''){\n    let toast = this.toastCtl.create({\n      message: msg,\n      position: 'top',\n      duration: 1000,\n      showCloseButton: true,\n      closeButtonText: 'ok',\n      dismissOnPageChange: true\n    });\n\n    toast.present();\n  }\n\n\n    getPosition(){\n    this.msg('Obtention des coordonnées en cours...');\n    this.geolocation.getCurrentPosition({enableHighAccuracy: true/*, maximumAge: 3000, timeout: 5000 */}).then((resp) => {\n      this.longitude = resp.coords.longitude;\n      this.latitude = resp.coords.latitude;\n      this.msg('Coordonnées obtenues avec succes!')\n    }, err => {\n      this.msg('Une erreur c\\'est produite lors de l\\obtention des coordonnées. \\nVeuillez reéssayer plus tard!')\n      console.log('')\n    });\n  }\n\n\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad ModifierChampsPage');\n  }\n\n  generateId(matricule){\n    var chars='ABCDEFGHIJKLMNPQRSTUVWYZ'\n    var numbers='0123456789'\n    var randomArray=[]\n    for(let i=0;i<3;i++){\n      var rand = Math.floor(Math.random()*10)\n      randomArray.push(numbers[rand])\n    }\n    //randomArray.push('-')\n    //var rand = Math.floor(Math.random()*24)\n    //randomArray.push(chars[rand])\n    var randomString=randomArray.join(\"\");\n    var Id= matricule+' '+/*+pays+'-'+region+'-'+department+'-'+commune +'-' +village+ */+randomString \n    return Id;\n  }\n\n   modifier(){\n      //  let date = new Date();\n    let champ = this.champsForm.value;\n\n    this.champs.id_champs = champ.id_champs;\n    this.champs.nom = champ.nom;\n    this.champs.longitude = champ.longitude;\n    this.champs.latitude = champ.latitude;\n    this.champs.superficie = champ.superficie;\n    this.champs.type_sole = champ.type_sole;\n    this.champs.matricule_producteur = champ.matricule_producteur;\n    this.champs.nom_producteur = champ.nom_producteur;\n    \n    /*if(this.verifierUniqueNon(typeSole, this.grandTypeSole._id) === 0){\n      alert('Le nom du type de sole doit être uniques!');\n    }else{*/\n      this.grandChamps.data = this.champs;\n      this.servicePouchdb.updateDoc(this.grandChamps);\n    \n      /*let toast = this.toastCtl.create({\n        message: 'Champs bien sauvegardée!',\n        position: 'top',\n        duration: 1000,\n        showCloseButton: true,\n        closeButtonText: 'ok',\n        dismissOnPageChange: true\n      });*/\n\n      this.navCtrl.pop();\n      //toast.present();\n      \n\n   // }\n  }\n\n  annuler(){\n    this.navCtrl.pop();\n  }\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/champs/modifier-champs/modifier-champs.ts"],"sourceRoot":""}