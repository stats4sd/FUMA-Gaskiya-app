<!--
  Generated template for the AjouterChamps page.

  See http://ionicframework.com/docs/v2/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar color="fuma_primary">
    <ion-buttons  left>
      <button ion-button icon-only color="royal" (click)="back()"> <ion-icon name="arrow-back"></ion-icon></button>
    </ion-buttons>

    <ion-title>ajouter-champs</ion-title>

    <!--ion-buttons end>
      <button ion-button icon-only color="royal" menuToggle><ion-icon name="settings"></ion-icon></button>
    </ion-buttons-->
  </ion-navbar>

</ion-header> 


<ion-content padding>

  <h5 *ngIf="champs.length > 0" style="text-align: center; color: seagreen">
    Champs: <span *ngFor="let champ of champs">{{champ.data.nom}} - </span>
  </h5>

    
<form [formGroup]="champsForm" (ngSubmit) = "ajouter()">

  <ion-item>
    <ion-label floating>Date <span class="error-box">*</span></ion-label>
    <ion-datetime displayFormat="DD/MM/YYYY" formControlName="today" cancelText="Annuler" doneText="Valider"></ion-datetime>
  </ion-item>

  <ng-template  #withFlags let-attrs="attrs">
    <span [innerHTML]="attrs.data.matricule_Membre | boldprefix:attrs.keyword"></span> -- <span [innerHTML]="attrs.data.nom_Membre"></span>
  </ng-template>

  <ion-row *ngIf="!matricule_producteur">
    <ion-col>
      
      <ion-auto-complete [dataProvider]="ServiceAutoCompletion" [template]="withFlags" [options]="{ placeholder : 'Matricule producteur' }" (itemSelected)="itemSelected($event)" ></ion-auto-complete>
      
    </ion-col>
  </ion-row>



  <ion-item *ngIf="matricule_producteur">
    <ion-label floating>Matricule producteur <span class="error-box">*</span></ion-label>
    <ion-input type="text" formControlName="matricule_producteur" [(ngModel)]="matricule_producteur" disabled></ion-input>
  </ion-item>
  

  <ion-item>
    <ion-label floating>Nom producteur <span class="error-box">*</span></ion-label>
    <ion-input type="text" formControlName="nom_producteur" [(ngModel)]="nom_producteur" disabled></ion-input>
  </ion-item>
  <div style="padding-left: 15px;" class="error-box" *ngIf="champsForm.controls['nom_producteur'].hasError('required') && champsForm.controls['nom_producteur'].touched">* le nom du producteur est obligatoir!</div>
   
  <ion-item>
    <ion-label floating>Nom du champs <span class="error-box">*</span></ion-label>
    <ion-input type="text" [(ngModel)]="nom" formControlName="nom" ></ion-input>
  </ion-item>
  <div style="padding-left: 15px;" class="error-box" *ngIf="champsForm.controls['nom'].hasError('required') && champsForm.controls['nom'].touched">* le nom du champs est obligatoir!</div>
  
  <ion-item> 
    <ion-label floating>Selectionnez le type de sole <span class="error-box">*</span></ion-label>
    <ion-select formControlName="type_sole" [(ngModel)]="type_sole" cancelText="Annuler" okText="Ok">
      <ion-option value="" selected disabled>Selectionnez le type de sole</ion-option>
      <ion-option *ngFor="let ts of typeSoles" [value]=ts.data.nom >{{ts.data.nom}}</ion-option>
    </ion-select> 
  </ion-item>
  <div style="padding-left: 15px;" class="error-box" *ngIf="champsForm.controls['type_sole'].hasError('required') && champsForm.controls['type_sole'].touched">* le type du sole est obligatoir!</div>

  <ion-item>
    <ion-label floating>Superficie (ha) <span class="error-box">*</span></ion-label>
    <ion-input type="number" [(ngModel)]="superficie" formControlName="superficie" ></ion-input>
  </ion-item>
  <div style="padding-left: 15px;" class="error-box" *ngIf="champsForm.controls['superficie'].hasError('required') && champsForm.controls['superficie'].touched">* la superficie est obligatoir!</div>

  <ion-item>
    <ion-label floating>Longitude</ion-label>
    <ion-input type="text" formControlName="longitude" [(ngModel)]="longitude" ></ion-input>
  </ion-item>

  <ion-item>
    <ion-label floating>Latitude</ion-label>
    <ion-input type="text" formControlName="latitude"  [(ngModel)]="latitude" ></ion-input>
  </ion-item>

    <br>
    <button ion-button type="submit" color="my_secondary" [disabled]="!champsForm.valid" block>Sauvegarder</button>
  </form>
  <button ion-button color="my_primary" block (click)="annuler()">Fermer</button>

  <ion-fab bottom right>
    <button ion-fab mini (click)="getPosition()"><ion-icon name="pin"></ion-icon></button>
  </ion-fab>

</ion-content>
